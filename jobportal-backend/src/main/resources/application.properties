# ========================================
# DATABASE CONFIGURATION
# ========================================
spring.application.name=jobportal-backend

# PostgreSQL Connection
spring.datasource.url=jdbc:postgresql://localhost:5432/jobportal_db
spring.datasource.username=postgres
spring.datasource.password=admin123

# Show SQL queries in console (for learning - disable in production!)
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true

# Auto-create/update tables from Java classes (MAGIC!)
spring.jpa.hibernate.ddl-auto=update

# Dialect (tells Hibernate to use PostgreSQL syntax)
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect

# ========================================
# SERVER CONFIGURATION
# ========================================
server.port=8080

# ========================================
# LOGGING (See what's happening)
# ========================================
logging.level.org.springframework.web=DEBUG
logging.level.com.jobportal.backend=DEBUG

# ========================================
# JWT CONFIGURATION
# ========================================
# Secret key for signing JWT (min 256 bits / 32 characters)
jwt.secret=mySecretKeyForJobPortalProjectRajveer2026ThisIsVerySecureKey123456789

# JWT token expiration time (15 minutes in milliseconds)
jwt.expiration=900000

# Refresh token expiration (7 days in milliseconds)
jwt.refresh-expiration=604800000

# ========================================
# OPENAI API CONFIGURATION
# ========================================
openai.api.key=${OPENAI_API_KEY}
openai.model=gpt-4o
openai.max.tokens=2000

# ========================================
# FILE UPLOAD CONFIGURATION
# ========================================
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB
file.upload-dir=uploads

# Allow frontend to access backend
spring.web.cors.allowed-origins=http://localhost:3000
spring.web.cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS
spring.web.cors.allowed-headers=*
spring.web.cors.allow-credentials=true

# ========================================
# CACHING CONFIGURATION - PRODUCTION READY
# ========================================
# Cache Type: caffeine (development), redis (production)
spring.cache.type=${CACHE_TYPE:caffeine}

# Caffeine Configuration (Development/Single Instance)
spring.cache.caffeine.spec=maximumSize=${CACHE_MAX_SIZE:10000},expireAfterAccess=${CACHE_ACCESS_EXPIRE:30m},expireAfterWrite=${CACHE_WRITE_EXPIRE:2h}

# Redis Configuration (Production/Distributed)
spring.data.redis.host=${REDIS_HOST:localhost}
spring.data.redis.port=${REDIS_PORT:6379}
spring.data.redis.password=${REDIS_PASSWORD:}
spring.data.redis.timeout=${REDIS_TIMEOUT:2000ms}
spring.data.redis.jedis.pool.max-active=${REDIS_POOL_MAX_ACTIVE:20}
spring.data.redis.jedis.pool.max-idle=${REDIS_POOL_MAX_IDLE:10}
spring.data.redis.jedis.pool.min-idle=${REDIS_POOL_MIN_IDLE:1}
spring.data.redis.database=${REDIS_DATABASE:0}

# Cache Settings
app.cache.enabled=${CACHE_ENABLED:true}
app.cache.default-ttl=${CACHE_DEFAULT_TTL:3600}
app.cache.jobs-ttl=${CACHE_JOBS_TTL:7200}
app.cache.search-ttl=${CACHE_SEARCH_TTL:1800}
app.cache.users-ttl=${CACHE_USERS_TTL:1800}

# ========================================
# EMAIL CONFIGURATION - PRODUCTION READY
# ========================================
# Primary Provider: Gmail SMTP (Default)
spring.mail.host=${MAIL_HOST:smtp.gmail.com}
spring.mail.port=${MAIL_PORT:587}
spring.mail.username=${MAIL_USERNAME:}
spring.mail.password=${MAIL_PASSWORD:}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.connectiontimeout=5000
spring.mail.properties.mail.smtp.timeout=3000
spring.mail.properties.mail.smtp.writetimeout=5000

# Alternative Providers (Configure via environment variables)
# SendGrid: MAIL_HOST=smtp.sendgrid.net, MAIL_USERNAME=apikey, MAIL_PASSWORD=${SENDGRID_API_KEY}
# AWS SES: MAIL_HOST=email-smtp.us-east-1.amazonaws.com, MAIL_USERNAME=${AWS_SES_USERNAME}, MAIL_PASSWORD=${AWS_SES_PASSWORD}
# Mailgun: MAIL_HOST=smtp.mailgun.org, MAIL_USERNAME=${MAILGUN_USERNAME}, MAIL_PASSWORD=${MAILGUN_PASSWORD}

# Email Application Settings
app.email.from=${MAIL_FROM_EMAIL:noreply@jobportal.com}
app.email.from-name=${MAIL_FROM_NAME:JobPortal}
app.email.reply-to=${MAIL_REPLY_TO:support@jobportal.com}
app.email.enabled=${MAIL_ENABLED:true}
app.email.test-mode=${MAIL_TEST_MODE:false}
app.email.max-retries=${MAIL_MAX_RETRIES:3}
app.email.retry-delay=${MAIL_RETRY_DELAY:5000}

# ========================================
# ASYNC CONFIGURATION - PRODUCTION OPTIMIZED
# ========================================
spring.task.execution.pool.core-size=${ASYNC_CORE_SIZE:10}
spring.task.execution.pool.max-size=${ASYNC_MAX_SIZE:50}
spring.task.execution.pool.queue-capacity=${ASYNC_QUEUE_CAPACITY:1000}
spring.task.execution.thread-name-prefix=jobportal-async-

# Email Specific Async Configuration
app.async.email.core-size=${EMAIL_ASYNC_CORE_SIZE:5}
app.async.email.max-size=${EMAIL_ASYNC_MAX_SIZE:20}
app.async.email.queue-capacity=${EMAIL_ASYNC_QUEUE_CAPACITY:500}

# ========================================
# PERFORMANCE MONITORING & METRICS
# ========================================
# Actuator Configuration
management.endpoints.web.exposure.include=health,metrics,prometheus,caches,info
management.endpoint.health.show-details=always
management.endpoint.metrics.enabled=true
management.endpoint.prometheus.enabled=true
management.metrics.export.prometheus.enabled=true

# Cache Metrics
management.metrics.cache.instrument=true
management.metrics.web.server.request.autotime.enabled=true

# Custom Metrics
app.metrics.enabled=${METRICS_ENABLED:true}
app.metrics.cache.enabled=${CACHE_METRICS_ENABLED:true}
app.metrics.email.enabled=${EMAIL_METRICS_ENABLED:true}

# ========================================
# PRODUCTION PERFORMANCE SETTINGS
# ========================================
# Database Connection Pool
spring.datasource.hikari.maximum-pool-size=${DB_POOL_MAX_SIZE:20}
spring.datasource.hikari.minimum-idle=${DB_POOL_MIN_IDLE:5}
spring.datasource.hikari.connection-timeout=${DB_CONNECTION_TIMEOUT:20000}
spring.datasource.hikari.idle-timeout=${DB_IDLE_TIMEOUT:300000}
spring.datasource.hikari.max-lifetime=${DB_MAX_LIFETIME:1200000}

# JPA Performance
spring.jpa.properties.hibernate.jdbc.batch_size=${JPA_BATCH_SIZE:25}
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.batch_versioned_data=true

# ========================================
# LOAD TESTING CONFIGURATION
# ========================================
# Load Testing (Enable with profile: load-test)
app.load-test.enabled=${LOAD_TEST_ENABLED:false}
app.load-test.concurrent-users=${LOAD_TEST_CONCURRENT_USERS:10}
app.load-test.requests-per-minute=${LOAD_TEST_RPM:100}
app.load-test.duration-minutes=${LOAD_TEST_DURATION:5}

# Stress Testing Thresholds
app.stress-test.max-response-time=${STRESS_TEST_MAX_RESPONSE:2000}
app.stress-test.error-threshold=${STRESS_TEST_ERROR_THRESHOLD:5}

# ========================================
# PRODUCTION ENVIRONMENT VARIABLES
# ========================================
# Instructions for Production Deployment:
# 
# 1. SMTP Configuration:
#    export MAIL_HOST=smtp.gmail.com
#    export MAIL_USERNAME=your-email@gmail.com
#    export MAIL_PASSWORD=your-app-password
#    export MAIL_FROM_EMAIL=noreply@yourcompany.com
#
# 2. Redis Configuration (Production):
#    export CACHE_TYPE=redis
#    export REDIS_HOST=your-redis-host
#    export REDIS_PASSWORD=your-redis-password
#
# 3. Database Configuration:
#    export DB_POOL_MAX_SIZE=50
#    export DB_POOL_MIN_IDLE=10
#
# 4. Performance Monitoring:
#    export METRICS_ENABLED=true
#    export CACHE_METRICS_ENABLED=true

# ========================================
# SECURITY CONFIGURATION - PRODUCTION READY
# ========================================
# Security Headers
app.security.content-security-policy=${CSP_POLICY:default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self'; connect-src 'self'}
app.security.hsts-max-age=${HSTS_MAX_AGE:31536000}
app.security.frame-options=${FRAME_OPTIONS:DENY}

# ========================================
# RATE LIMITING CONFIGURATION
# ========================================
app.rate-limit.enabled=${RATE_LIMIT_ENABLED:true}
app.rate-limit.requests-per-minute=${RATE_LIMIT_RPM:60}
app.rate-limit.burst-requests=${RATE_LIMIT_BURST:10}
app.rate-limit.auth-requests-per-minute=${AUTH_RATE_LIMIT_RPM:10}
app.rate-limit.search-requests-per-minute=${SEARCH_RATE_LIMIT_RPM:100}

# ========================================
# LOGGING CONFIGURATION - ENTERPRISE GRADE
# ========================================
app.logging.level=${LOG_LEVEL:INFO}
app.logging.file.enabled=${LOG_FILE_ENABLED:false}
app.logging.file.path=${LOG_FILE_PATH:/var/log/jobportal}
app.logging.request.enabled=${LOG_REQUESTS:true}
app.logging.performance.enabled=${LOG_PERFORMANCE:true}
app.logging.security.enabled=${LOG_SECURITY:true}

# Logback configuration for production JSON logging
logging.config=${LOGGING_CONFIG:classpath:logback-spring.xml}

# ========================================
# API DOCUMENTATION CONFIGURATION
# ========================================
app.api.version=${API_VERSION:1.0.0}
app.api.title=${API_TITLE:JobPortal API}
app.api.description=${API_DESCRIPTION:AI-Powered Job Portal Backend API}
app.api.server-url=${API_SERVER_URL:http://localhost:8080}
app.api.server-description=${API_SERVER_DESC:Development Server}

# SpringDoc OpenAPI Configuration
springdoc.api-docs.path=${API_DOCS_PATH:/v3/api-docs}
springdoc.swagger-ui.path=${SWAGGER_UI_PATH:/swagger-ui.html}
springdoc.swagger-ui.enabled=${SWAGGER_UI_ENABLED:true}
springdoc.swagger-ui.tryItOutEnabled=${SWAGGER_TRY_ENABLED:true}

# ========================================
# HEALTH CHECK CONFIGURATION
# ========================================
management.endpoints.web.exposure.include=health,metrics,prometheus,caches,info,env,beans
management.endpoint.health.show-details=${HEALTH_DETAILS:when_authorized}
management.endpoint.health.show-components=always
management.health.probes.enabled=true
management.health.livenessstate.enabled=true
management.health.readinessstate.enabled=true

# Custom health checks
app.health.database.enabled=${HEALTH_DB_ENABLED:true}
app.health.cache.enabled=${HEALTH_CACHE_ENABLED:true}
app.health.email.enabled=${HEALTH_EMAIL_ENABLED:true}
app.health.external.enabled=${HEALTH_EXTERNAL_ENABLED:true}

